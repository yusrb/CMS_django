{% include 'base.html' %}
<header class="bg-black text-white z-10" style="background-color: {{ konfigurasis.navbar_page_color }};">
    <div class="container relative mx-auto flex flex-col text-white items-center py-4 px-6">
        <h1 class="text-4xl font-bold mb-2">Aspire CMS</h1>

        <div class="flex items-center w-full mb-4 justify-between">
            <ul class="flex flex-wrap justify-center space-x-4 flex-grow">
                <li>
                    <button class="kategori-btn text-white relative top-[5px] hover:underline" data-kategori-id="all">Semua Kategori</button>
                </li>
                {% for kategori in kategori_kontens %}
                    <li>
                        <button class="kategori-btn text-white relative top-[5px] hover:underline" data-kategori-id="{{ kategori.pk }}">{{ kategori.kategori }}</button>
                    </li>
                {% empty %}
                    <li class="text-gray-500">Tidak ada kategori tersedia.</li>
                {% endfor %}
            </ul>

            <div class="relative top-1 flex items-center">
                <button id="profile-button" class="flex items-center ml-4">
                    <i class='bx bx-user text-2xl'></i>
                </button>
                <div id="user-dropdown" class="absolute z-50 right-0 mt-2 w-48 bg-white text-black rounded-md shadow-lg hidden transition-opacity duration-300 ease-in-out opacity-0">
                    <a href="#" class="block px-4 py-2 hover:bg-gray-200 rounded-t-md">Profil</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-200">Pengaturan</a>
                    <a href="#" class="block px-4 py-2 hover:bg-gray-200 rounded-b-md">Keluar</a>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="container mx-auto px-4 py-8 flex flex-col lg:flex-row lg:space-x-8">
    <main class="w-full lg:w-4/5 mb-8 lg:mb-0"> <!-- Memperlebar konten utama lebih jauh -->
        <article class="bg-white shadow-md rounded-lg p-6 relative">
            <div class="absolute left-4 top-4 text-6xl text-gray-300">
                <span>1</span>
            </div>

            <h1 class="text-5xl font-bold mb-4">{{ konten.judul }}</h1>
            <div class="flex items-center mb-4">
                <p class="text-gray-700">Ditulis oleh: <span class="font-semibold">{{ konten.username }}</span></p>
                <span class="mx-2 text-gray-400">|</span>
                <p class="text-gray-600">{{ konten.tanggal|date:"d M Y, H:i" }} WIB</p>
            </div>

            {% if konten.foto %}
                <img src="{{ konten.foto.url }}" alt="{{ konten.judul }}" class="rounded-lg shadow-lg mb-4 w-full"> <!-- Lebar maksimum diatur ke full -->
            {% endif %}

            <div class="text-gray-800 leading-relaxed mb-6">
                {{ konten.isi_konten|safe }}
            </div>
        </article>

        <div class="konten-lainnya mt-8">
            <h3 class="text-2xl font-semibold mb-2">Konten Lainnya:</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for konten in konten_lain %}
                    <div class="bg-white shadow-md rounded-lg p-4">
                        {% if konten.foto %}
                            <img src="{{ konten.foto.url }}" alt="{{ konten.judul }}" class="rounded-md mb-2 w-full h-24 object-cover">
                        {% endif %}
                        <h4 class="font-semibold mb-2">
                            <a href="{% url 'user:konten_detail' konten.slug %}" class="text-blue-500 hover:underline">{{ konten.judul }}</a>
                        </h4>
                        <p class="text-gray-500 text-sm">{{ konten.tanggal|date:"d M Y" }}</p>
                    </div>
                {% empty %}
                    <p class="text-gray-500">Tidak ada konten lainnya.</p>
                {% endfor %}
            </div>
        </div>

        <a href="{% url 'user:konten_list' %}" class="mt-4 inline-block text-blue-600 hover:underline">Kembali ke Daftar Konten</a>
    </main>

    <!-- Sidebar untuk Post Terpopuler -->
    <aside class="w-full lg:w-1/5"> <!-- Memperkecil sidebar -->
        <div class="bg-white shadow-md rounded-lg p-4">
            <h2 class="text-xl font-semibold mb-4">Post Terpopuler</h2> <!-- Ukuran font judul sidebar diubah -->
            <ul class="space-y-2">
                {% for post in top_posts %}
                    <li class="flex items-center">
                        {% if post.foto %}
                            <img src="{{ post.foto.url }}" alt="{{ post.judul }}" class="rounded-md mr-2 w-10 h-10 object-cover"> <!-- Mengubah ukuran gambar -->
                        {% endif %}
                        <div class="flex-1"> <!-- Mengizinkan div ini untuk mengisi ruang yang tersisa -->
                            <a href="{% url 'user:konten_detail' post.slug %}" class="text-blue-500 hover:underline">{{ post.judul }}</a>
                            <p class="text-gray-500 text-xs">{{ post.tanggal|date:"d M Y" }}</p> <!-- Ukuran font diubah menjadi lebih kecil -->
                        </div>
                    </li>
                {% empty %}
                    <li class="text-gray-500">Tidak ada post terpopuler.</li>
                {% endfor %}
            </ul>
        </div>
    </aside>
</div>

<script>
    document.getElementById('profile-button').addEventListener('click', function () {
        const dropdown = document.getElementById('user-dropdown');
        dropdown.classList.toggle('hidden');
        dropdown.classList.toggle('opacity-100');
    });

    window.addEventListener('click', function (event) {
        const dropdown = document.getElementById('user-dropdown');
        if (!event.target.matches('#profile-button') && !dropdown.contains(event.target)) {
            dropdown.classList.add('hidden');
            dropdown.classList.remove('opacity-100');
        }
    });
</script>
